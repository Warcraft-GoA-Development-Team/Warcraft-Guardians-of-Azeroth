#
#	1		-	49		- craft
#	50		-	99		- craft pings
#	100		-	149		- market
#	150		-	199		- market pings
#	200		-	249		- search
#	250		-	299		- search pings
#
#	900		-	999		- pings
#

namespace = WCAE

character_event = {
	id = WCAE.1 #Artifact Up
	desc = EVTDESC_WCAE_2

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	option = { #Generic upgrades

		trigger = {
			event_target:improved_artifact = {
				OR = {
					# top hats
					artifact_type = top_hat
					artifact_type = top_hat_2
					artifact_type = top_hat_3
					# daggers
					artifact_type = dagger_1
					artifact_type = dagger_2
					artifact_type = dagger_3
					artifact_type = dagger_4
					# rings
					artifact_type = ring_2_diplomacy
					artifact_type = ring_3_diplomacy
					artifact_type = ring_4_diplomacy
					artifact_type = ring_2_martial
					artifact_type = ring_3_martial
					artifact_type = ring_4_martial
					artifact_type = ring_2_stewardship
					artifact_type = ring_3_stewardship
					artifact_type = ring_4_stewardship
					artifact_type = ring_2_intrigue
					artifact_type = ring_3_intrigue
					artifact_type = ring_4_intrigue
					artifact_type = ring_2_learning
					artifact_type = ring_3_learning
					artifact_type = ring_4_learning
					# amulets
					artifact_type = amulet_2_diplomacy
					artifact_type = amulet_3_diplomacy
					artifact_type = amulet_4_diplomacy
					artifact_type = amulet_2_martial
					artifact_type = amulet_3_martial
					artifact_type = amulet_4_martial
					artifact_type = amulet_2_stewardship
					artifact_type = amulet_3_stewardship
					artifact_type = amulet_4_stewardship
					artifact_type = amulet_2_intrigue
					artifact_type = amulet_3_intrigue
					artifact_type = amulet_4_intrigue
					artifact_type = amulet_2_learning
					artifact_type = amulet_3_learning
					artifact_type = amulet_4_learning
					# crowns
					artifact_type = crown_1
					artifact_type = crown_2
					artifact_type = crown_3
					# cloaks
					artifact_type = cloak_1
				}
			}
		}

		artifact_random_up_effect = yes

		name = {
			text = EVTOPT_WCAE_4
			trigger = {
				event_target:improved_artifact = {
					OR = {
						artifact_type = top_hat
						artifact_type = top_hat_2
						artifact_type = top_hat_3
					}
				}
			}
		}

		name = {
			text = EVTOPT_WCAE_8
			trigger = {
				event_target:improved_artifact = {
					artifact_type = top_hat_3
				}
			}
		}

		name = {
			text = EVTOPT_WCAE_5
			trigger = {
				event_target:improved_artifact = {
					OR = {
						artifact_type = dagger_1
						artifact_type = dagger_2
						artifact_type = dagger_3
						artifact_type = dagger_4
					}
				}
			}
		}

		name = {
			text = EVTOPT_WCAE_6
			trigger = {
				event_target:improved_artifact = {
					OR = {
						artifact_type = cloak_1
						artifact_type = crown_1
						artifact_type = crown_2
						artifact_type = crown_3
						artifact_type = ring_2_diplomacy
						artifact_type = ring_3_diplomacy
						artifact_type = ring_4_diplomacy
						artifact_type = ring_2_martial
						artifact_type = ring_3_martial
						artifact_type = ring_4_martial
						artifact_type = ring_2_stewardship
						artifact_type = ring_3_stewardship
						artifact_type = ring_4_stewardship
						artifact_type = ring_2_intrigue
						artifact_type = ring_3_intrigue
						artifact_type = ring_4_intrigue
						artifact_type = ring_2_learning
						artifact_type = ring_3_learning
						artifact_type = ring_4_learning
						artifact_type = amulet_2_diplomacy
						artifact_type = amulet_3_diplomacy
						artifact_type = amulet_4_diplomacy
						artifact_type = amulet_2_martial
						artifact_type = amulet_3_martial
						artifact_type = amulet_4_martial
						artifact_type = amulet_2_stewardship
						artifact_type = amulet_3_stewardship
						artifact_type = amulet_4_stewardship
						artifact_type = amulet_2_intrigue
						artifact_type = amulet_3_intrigue
						artifact_type = amulet_4_intrigue
						artifact_type = amulet_2_learning
						artifact_type = amulet_3_learning
						artifact_type = amulet_4_learning
					}
				}
			}
		}

	}

	option = { # specials

		trigger = {
			OR = {
				AND = {
					event_target:improved_artifact = {
						artifact_type = top_hat
					}
					OR = {
						culture = pirate_culture
						culture = blackwater
					}
				}
				event_target:improved_artifact = { artifact_type = cloak_blue	}
				event_target:improved_artifact = { artifact_type = cloak_red	}
			}
		}

		event_target:improved_artifact = {
			set_artifact_flag = up_to_pirate_hat
		}

		custom_tooltip = { text = special_option_artifact_improve_tt }
		artifact_random_up_effect = yes

		name = {
			text = EVTOPT_WCAE_3
			trigger = { event_target:improved_artifact = { artifact_type = top_hat } }
		}

		name = {
			text = EVTOPT_WCAE_7
			trigger = {
				OR = {
					event_target:improved_artifact = { artifact_type = cloak_blue	}
					event_target:improved_artifact = { artifact_type = cloak_red	}
				}
			}
		}
	}

	option = { # paint blue

		trigger = {
			OR = {
				AND = {
					event_target:improved_artifact = {
						artifact_type = pirate_admiral_hat
					}
					OR = {
						culture = pirate_culture
						culture = blackwater
					}
				}
				event_target:improved_artifact = { artifact_type = ring_1	}
				event_target:improved_artifact = { artifact_type = amulet_1	}
				event_target:improved_artifact = { artifact_type = cloak_2	}
			}
		}

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_blue
		}

		artifact_random_up_effect = yes

		tooltip_info = diplomacy
		name = {
			text = EVTOPT_WCAE_blue
			trigger = {
				OR = {
					event_target:improved_artifact = { artifact_type = pirate_admiral_hat	}
					event_target:improved_artifact = { artifact_type = cloak_2				}
				}
			}
		}

		name = {
			text = EVTOPT_WCAE_blue_stone
			trigger = {
				OR = {
					event_target:improved_artifact = { artifact_type = ring_1	}
					event_target:improved_artifact = { artifact_type = amulet_1	}
				}
			}
		}
	}

	option = { # paint red

		trigger = {
			OR = {
				AND = {
					event_target:improved_artifact = {
						artifact_type = pirate_admiral_hat
					}
					culture = pirate_culture
				}
				event_target:improved_artifact = { artifact_type = ring_1	}
				event_target:improved_artifact = { artifact_type = amulet_1	}
				event_target:improved_artifact = { artifact_type = cloak_2	}
			}
		}

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_red
		}

		artifact_random_up_effect = yes

		tooltip_info = martial
		name = {
			text = EVTOPT_WCAE_red
			trigger = {
				OR = {
					event_target:improved_artifact = { artifact_type = pirate_admiral_hat	}
					event_target:improved_artifact = { artifact_type = cloak_2				}
				}
			}
		}

		name = {
			text = EVTOPT_WCAE_red_stone
			trigger = {
				OR = {
					event_target:improved_artifact = { artifact_type = ring_1	}
					event_target:improved_artifact = { artifact_type = amulet_1	}
				}
			}
		}
	}

	option = { # paint green

		trigger = {
			OR = {
				AND = {
					event_target:improved_artifact = {
						artifact_type = pirate_admiral_hat
					}
					culture = blackwater
				}
				event_target:improved_artifact = { artifact_type = ring_1	}
				event_target:improved_artifact = { artifact_type = amulet_1	}
				event_target:improved_artifact = { artifact_type = cloak_2	}
			}
		}

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_green
		}

		artifact_random_up_effect = yes

		tooltip_info = stewardship
		name = {
			text = EVTOPT_WCAE_green
			trigger = {
				OR = {
					event_target:improved_artifact = { artifact_type = pirate_admiral_hat	}
					event_target:improved_artifact = { artifact_type = cloak_2				}
				}
			}
		}

		name = {
			text = EVTOPT_WCAE_green_stone
			trigger = {
				OR = {
					event_target:improved_artifact = { artifact_type = ring_1	}
					event_target:improved_artifact = { artifact_type = amulet_1	}
				}
			}
		}
	}

	option = { #PRDX WHY
		trigger = {
			event_target:improved_artifact = {
				has_flag = four_or_more_up_choices
			}
		}
		name = EVTOPT_WCMEME_back

		character_event = { id = WCAE.2 }
	}

	option = { #Exit

		name = EVT_OPTD_MNM_9310
		event_target:improved_artifact = {
			clear_event_target = improved_artifact
			clr_artifact_flag = improved_artifact
		}

		prestige = -10

		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_

		ai_chance = {
			factor = 0
		}
	}
}

#Only 4 max option, so there additionals
character_event = {
	id = WCAE.2

	desc = EVTDESC_WCAE_2

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	option = { # paint violet

		trigger = {
			OR = {
				event_target:improved_artifact = { artifact_type = ring_1	}
				event_target:improved_artifact = { artifact_type = amulet_1	}
				event_target:improved_artifact = { artifact_type = cloak_2	}
			}
		}

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_violet
		}

		artifact_random_up_effect = yes

		tooltip_info = intrigue
		name = {
			text = EVTOPT_WCAE_violet
			trigger = {
				event_target:improved_artifact = { artifact_type = cloak_2 }
			}
		}

		name = {
			text = EVTOPT_WCAE_violet_stone
			trigger = {
				OR = {
					event_target:improved_artifact = { artifact_type = ring_1	}
					event_target:improved_artifact = { artifact_type = amulet_1	}
				}
			}
		}
	}

	option = { # paint white

		trigger = {
			OR = {
				event_target:improved_artifact = { artifact_type = ring_1	}
				event_target:improved_artifact = { artifact_type = amulet_1	}
				event_target:improved_artifact = { artifact_type = cloak_2	}
			}
		}

		event_target:improved_artifact = {
			set_artifact_flag = paint_it_white
		}

		artifact_random_up_effect = yes

		tooltip_info = learning
		name = {
			text = EVTOPT_WCAE_white
			trigger = {
				event_target:improved_artifact = { artifact_type = cloak_2 }
			}
		}

		name = {
			text = EVTOPT_WCAE_white_stone
			trigger = {
				OR = {
					event_target:improved_artifact = { artifact_type = ring_1	}
					event_target:improved_artifact = { artifact_type = amulet_1	}
				}
			}
		}
	}

	# option = { # more than 4 variants generic upgrades ### OBSOLETE ###

		# trigger = {
			# event_target:improved_artifact = {
				# OR = {
					# artifact_type = ring_1 # ring_1 to ring_2 to ring_3
					# artifact_type = ring_2
				# }
			# }
		# }

		# artifact_random_up_effect = yes

		# name = EVTOPT_WCAE_6
	# }

	option = { # Back
		name = EVTOPT_WCMEME_back

		character_event = { id = WCAE.1 }

		ai_chance = {
			factor = 0
		}
	}

	option = { # Exit

		name = EVT_OPTD_MNM_9310
		event_target:improved_artifact = {
			clear_event_target = improved_artifact
			clr_artifact_flag = improved_artifact
		}

		prestige = -10

		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_

		ai_chance = {
			factor = 0
		}
	}

}

#Results
character_event = { # success
	id = WCAE.3
	desc = EVTDESC_WCAE_7

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	immediate = {

		if = {
			limit = {
				event_target:improved_artifact = {
					artifact_type = pirate_admiral_hat
					OR = {
						has_flag = paint_it_blue
						has_flag = paint_it_red
						has_flag = paint_it_green
					}
				}
			}
			event_target:improved_artifact = { # Paint Pirate Hat
				trigger_switch = {
					on_trigger = has_flag
					paint_it_blue 	= { artifact_owner = { add_artifact = pirate_admiral_hat_blue } }
					paint_it_red 	= { artifact_owner = { add_artifact = pirate_admiral_hat_red } }
					paint_it_green 	= { artifact_owner = { add_artifact = pirate_admiral_hat_green } }
				}
			}
		}

		if = {
			limit = {
				event_target:improved_artifact = {
					artifact_type = ring_1
					OR = {
						has_flag = paint_it_blue
						has_flag = paint_it_red
						has_flag = paint_it_green
						has_flag = paint_it_violet
						has_flag = paint_it_white
					}
				}
			}
			event_target:improved_artifact = { # Paint Ring
				trigger_switch = {
					on_trigger = has_flag
					paint_it_blue 	= { artifact_owner = { add_artifact = ring_2_diplomacy		} }
					paint_it_red 	= { artifact_owner = { add_artifact = ring_2_martial		} }
					paint_it_green 	= { artifact_owner = { add_artifact = ring_2_stewardship	} }
					paint_it_violet = { artifact_owner = { add_artifact = ring_2_intrigue		} }
					paint_it_white	= { artifact_owner = { add_artifact = ring_2_learning		} }
				}
			}
		}

		if = {
			limit = {
				event_target:improved_artifact = {
					artifact_type = amulet_1
					OR = {
						has_flag = paint_it_blue
						has_flag = paint_it_red
						has_flag = paint_it_green
						has_flag = paint_it_violet
						has_flag = paint_it_white
					}
				}
			}
			event_target:improved_artifact = { # Paint Amulet
				trigger_switch = {
					on_trigger = has_flag
					paint_it_blue 	= { artifact_owner = { add_artifact = amulet_2_diplomacy	} }
					paint_it_red 	= { artifact_owner = { add_artifact = amulet_2_martial		} }
					paint_it_green 	= { artifact_owner = { add_artifact = amulet_2_stewardship	} }
					paint_it_violet = { artifact_owner = { add_artifact = amulet_2_intrigue		} }
					paint_it_white	= { artifact_owner = { add_artifact = amulet_2_learning		} }
				}
			}
		}

		if = {
			limit = {
				event_target:improved_artifact = {
					artifact_type = cloak_2
					OR = {
						has_flag = paint_it_blue
						has_flag = paint_it_red
						has_flag = paint_it_green
						has_flag = paint_it_violet
						has_flag = paint_it_white
					}
				}
			}
			event_target:improved_artifact = { # Paint Cloak
				trigger_switch = {
					on_trigger = has_flag
					paint_it_blue 	= { artifact_owner = { add_artifact = cloak_blue	} }
					paint_it_red 	= { artifact_owner = { add_artifact = cloak_red		} }
					paint_it_green 	= { artifact_owner = { add_artifact = cloak_green	} }
					paint_it_violet = { artifact_owner = { add_artifact = cloak_violet	} }
					paint_it_white	= { artifact_owner = { add_artifact = cloak_white	} }
				}
			}
		}

		if = {
			limit = {
				event_target:improved_artifact = {
					has_flag = up_to_pirate_hat
					OR = {
						artifact_type = top_hat
						artifact_type = cloak_blue
						artifact_type = cloak_red
					}
				}
			}

			event_target:improved_artifact = { # Specials
				trigger_switch = {
					on_trigger = artifact_type
					top_hat 			= { artifact_owner = { add_artifact = pirate_admiral_hat	} }
					cloak_blue 			= { artifact_owner = { add_artifact = cloak_alliance		} }
					cloak_red 			= { artifact_owner = { add_artifact = cloak_horde			} }
				}
			}
		}

		if = {
			limit = {
				NOT = {
					event_target:improved_artifact = {
						OR = {
							has_flag = up_to_pirate_hat
							has_flag = paint_it_blue
							has_flag = paint_it_red
							has_flag = paint_it_green
							has_flag = paint_it_violet
							has_flag = paint_it_white
						}
					}
				}
			}

			event_target:improved_artifact = { # Generic upgrades
				trigger_switch = {
					on_trigger = artifact_type
					crown_3 				= { artifact_owner = { add_artifact = crown_4	 			} }
					crown_2 				= { artifact_owner = { add_artifact = crown_3	 			} }
					crown_1 				= { artifact_owner = { add_artifact = crown_2				} }
					top_hat_3 				= { artifact_owner = { add_artifact = top_hat_4 			} }
					top_hat_2 				= { artifact_owner = { add_artifact = top_hat_3 			} }
					top_hat 				= { artifact_owner = { add_artifact = top_hat_2				} }
					dagger_4				= { artifact_owner = { add_artifact = dagger_5				} }
					dagger_3				= { artifact_owner = { add_artifact = dagger_4				} }
					dagger_2				= { artifact_owner = { add_artifact = dagger_3				} }
					dagger_1				= { artifact_owner = { add_artifact = dagger_2				} }
					ring_2_diplomacy		= { artifact_owner = { add_artifact = ring_3_diplomacy		} }
					ring_3_diplomacy		= { artifact_owner = { add_artifact = ring_4_diplomacy		} }
					ring_4_diplomacy		= { artifact_owner = { add_artifact = ring_5_diplomacy		} }
					ring_2_martial			= { artifact_owner = { add_artifact = ring_3_martial		} }
					ring_3_martial			= { artifact_owner = { add_artifact = ring_4_martial		} }
					ring_4_martial			= { artifact_owner = { add_artifact = ring_5_martial		} }
					ring_2_stewardship		= { artifact_owner = { add_artifact = ring_3_stewardship	} }
					ring_3_stewardship		= { artifact_owner = { add_artifact = ring_4_stewardship	} }
					ring_4_stewardship		= { artifact_owner = { add_artifact = ring_5_stewardship	} }
					ring_2_intrigue			= { artifact_owner = { add_artifact = ring_3_intrigue		} }
					ring_3_intrigue			= { artifact_owner = { add_artifact = ring_4_intrigue		} }
					ring_4_intrigue			= { artifact_owner = { add_artifact = ring_5_intrigue		} }
					ring_2_learning			= { artifact_owner = { add_artifact = ring_3_learning		} }
					ring_3_learning			= { artifact_owner = { add_artifact = ring_4_learning		} }
					ring_4_learning			= { artifact_owner = { add_artifact = ring_5_learning		} }
					amulet_2_diplomacy		= { artifact_owner = { add_artifact = amulet_3_diplomacy	} }
					amulet_3_diplomacy		= { artifact_owner = { add_artifact = amulet_4_diplomacy	} }
					amulet_4_diplomacy		= { artifact_owner = { add_artifact = amulet_5_diplomacy	} }
					amulet_2_martial		= { artifact_owner = { add_artifact = amulet_3_martial		} }
					amulet_3_martial		= { artifact_owner = { add_artifact = amulet_4_martial		} }
					amulet_4_martial		= { artifact_owner = { add_artifact = amulet_5_martial		} }
					amulet_2_stewardship	= { artifact_owner = { add_artifact = amulet_3_stewardship	} }
					amulet_3_stewardship	= { artifact_owner = { add_artifact = amulet_4_stewardship	} }
					amulet_4_stewardship	= { artifact_owner = { add_artifact = amulet_5_stewardship	} }
					amulet_2_intrigue		= { artifact_owner = { add_artifact = amulet_3_intrigue		} }
					amulet_3_intrigue		= { artifact_owner = { add_artifact = amulet_4_intrigue		} }
					amulet_4_intrigue		= { artifact_owner = { add_artifact = amulet_5_intrigue		} }
					amulet_2_learning		= { artifact_owner = { add_artifact = amulet_3_learning		} }
					amulet_3_learning		= { artifact_owner = { add_artifact = amulet_4_learning		} }
					amulet_4_learning		= { artifact_owner = { add_artifact = amulet_5_learning		} }
					cloak_1					= { artifact_owner = { add_artifact = cloak_2				} }
				}
			}
		}

		new_artifact = {
			copy_artifact_history = event_target:improved_artifact
			set_artifact_original_owner = ROOT
		}
		event_target:improved_artifact = {
			clr_artifact_flag = up_to_pirate_hat
			clear_flags_with_prefix = paint_it_
			clr_artifact_flag = improved_artifact
			clear_event_target = improved_artifact
			destroy_artifact = yes
		}

	}

	after = {
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}

	option = {
		name = EVTOPT_WCMEME_excellent

		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = 25 } }
				improved_artifact_2 = { ROOT = { prestige = 50 } }
				improved_artifact_3 = { ROOT = { prestige = 100 } }
				improved_artifact_4 = { ROOT = { prestige = 250 } }
			}
		}
	}
}

character_event = { # minor failure
	id = WCAE.4
	desc = EVTDESC_WCAE_5

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	immediate = {
		event_target:improved_artifact = {
			clear_event_target = improved_artifact
			clr_artifact_flag = improved_artifact
		}
	}

	after = {
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}

	option = {
		name = EVTOPT_WCMEME_baka

		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -25		} }
				improved_artifact_2 = { ROOT = { prestige = -50		} }
				improved_artifact_3 = { ROOT = { prestige = -100	} }
				improved_artifact_4 = { ROOT = { prestige = -250	} }
			}
		}
	}

	option = {
		name = EVTOPT_WCMEME_punishment

		trigger = {
			OR = {
				trait =	cruel
				trait = greedy
				trait = wroth
				trait =	impaler
				has_character_modifier = the_cruel
			}
		}

		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { 					piety = -25	} }
				improved_artifact_2 = { ROOT = { prestige = -25		piety = -25	} }
				improved_artifact_3 = { ROOT = { prestige = -50		piety = -25	} }
				improved_artifact_4 = { ROOT = { prestige = -125	piety = -25	} }
			}
		}

		set_character_flag = artifact_up_minor_failure
		# character_event = { id = WCAE.900 } --- redo
	}

	option = {
		name = EVTOPT_WCMEME_too_kind

		trigger = {
			OR = {
				trait =	kind
				trait =	charitable
				has_character_modifier = the_kind
			}
		}

		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -25		piety = 12.5 } }
				improved_artifact_2 = { ROOT = { prestige = -50		piety = 25	} }
				improved_artifact_3 = { ROOT = { prestige = -100	piety = 50	} }
				improved_artifact_4 = { ROOT = { prestige = -250	piety = 125	} }
			}
		}

		set_character_flag = artifact_up_minor_failure
		# character_event = { id = WCAE.901 } --- redo
	}
}

character_event = { # failure
	id = WCAE.5
	desc = EVTDESC_WCAE_6

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	immediate = {
		event_target:improved_artifact = {
			clear_event_target = improved_artifact
			set_description = artifact_damaged_not_improved_desc_rename
		}

	}

	after = {
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}

	option = {
		name = EVTOPT_WCMEME_baka

		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -50		} }
				improved_artifact_2 = { ROOT = { prestige = -100	} }
				improved_artifact_3 = { ROOT = { prestige = -250	} }
				improved_artifact_4 = { ROOT = { prestige = -500	} }
			}
		}
	}

	option = {
		name = EVTOPT_WCMEME_punishment

		trigger = {
			OR = {
				trait =	cruel
				trait = greedy
				trait = wroth
				trait =	impaler
				has_character_modifier = the_cruel
			}
		}

		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -25		piety = -25 } }
				improved_artifact_2 = { ROOT = { prestige = -50		piety = -25	} }
				improved_artifact_3 = { ROOT = { prestige = -125	piety = -25	} }
				improved_artifact_4 = { ROOT = { prestige = -250	piety = -25	} }
			}
		}

		set_character_flag = artifact_up_failure
		# character_event = { id = WCAE.900 } --- redo
	}

	option = {
		name = EVTOPT_WCMEME_too_kind

		trigger = {
			OR = {
				trait =	kind
				trait =	charitable
				has_character_modifier = the_kind
			}
		}

		set_character_flag = artifact_up_failure
		# character_event = { id = WCAE.901 } --- redo

		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -50		piety = 25 } }
				improved_artifact_2 = { ROOT = { prestige = -100	piety = 50	} }
				improved_artifact_3 = { ROOT = { prestige = -250	piety = 125	} }
				improved_artifact_4 = { ROOT = { prestige = -500	piety = 250	} }
			}
		}
	}
}

character_event = { # critical failure
	id = WCAE.6
	desc = EVTDESC_WCAE_4_1
	desc = EVTDESC_WCAE_4_2

	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	immediate = {
		event_target:improved_artifact = {
			clear_event_target = improved_artifact
			clr_artifact_flag = improved_artifact
			destroy_artifact = yes
		}
	}

	after = {
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = improved_artifact_
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}

	option = {
		name = EVTOPT_WCMEME_less_good_man

		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				improved_artifact_1 = { ROOT = { prestige = -100 } }
				improved_artifact_2 = { ROOT = { prestige = -250 } }
				improved_artifact_3 = { ROOT = { prestige = -500 } }
				improved_artifact_4 = { ROOT = { prestige = -1000 } }
			}
		}
	}
}


# Market Results

character_event = { # success
	id = WCAE.100
	desc = EVTDESC_WCAE_8

	picture = GFX_evt_market
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	after = {
		hidden_effect = {
			set_variable = { which = artifact_market_cost_variable value = 0 }
		}
	}

	option = { # Ok
		name = EVTOPT_WCMEME_ok

		wealth = artifact_market_cost_variable

		if = {
			limit = {
				has_character_flag = bought_artifact_is_fake
			}
			character_event = { id = WCAE.102 days = 240 random = 240 }
		}
		else_if = {
			limit = {
				has_character_flag = bought_artifact_difficult_to_find
			}
			character_event = { id = WCAE.103 days = 240 random = 120 }
		}
		else = {
			character_event = { id = WCAE.103 days = 120 random = 60 }
		}
	}
	option = { # Nope
		name = EVT_OPTD_MNM_9310
		prestige = -5

		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}
}

character_event = { # failure
	id = WCAE.101
	desc = EVTDESC_WCAE_9_1
	desc = EVTDESC_WCAE_9_2

	picture = GFX_evt_market_hf
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	option = {
		name = EVTOPT_WCMEME_less_good_man

		prestige = -25
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}
}

character_event = { # critical failure
	id = WCAE.102
	desc = EVTDESC_WCAE_9_1

	picture = GFX_evt_market_hf
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	option = {
		name = EVTOPT_WCMEME_less_good_man

		prestige = -50
		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}
}

character_event = { # craft done
	id = WCAE.103
	desc = EVTDESC_WCAE_

	picture = GFX_evt_market
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes

	option = {
		name = EVTOPT_WCMEME_ok

		ROOT = {
			show_scope_change = no
			trigger_switch = {
				on_trigger = has_flag
				bought_artifact_top_hat			= {	add_artifact = top_hat	}
				bought_artifact_rogue_dagger	= {	add_artifact = dagger_1	}
				bought_artifact_copper_ring		= {	add_artifact = ring_1	}
				bought_artifact_amulet			= {	add_artifact = amulet_1	}
				bought_artifact_ruler_crown		= {	add_artifact = crown_1	}
				bought_artifact_cloak			= {	add_artifact = cloak_1	}
			}
		}

		clr_character_flag = bought_thing_recently
		clear_flags_with_prefix = bought_from_
		clear_flags_with_prefix = bought_artifact_
	}
}

# Market Pings

character_event = { # Rly wanna?
	id = WCAE.150
	desc = EVTDESC_WCAE_150

	picture = GFX_evt_rider_adventure
	border = GFX_event_normal_frame_economy

	is_triggered_only = yes
	hide_from = yes
	hide_new = yes

	trigger = {
		char_can_buy_artifacts_no_flag_trigger = yes
	}

	# fail_trigger_effect = {
		# character_event = { character_event = { id = ID } }
	# }

	immediate = {
		hidden_effect = {
			save_event_target_as = target_artifact_craftsman_employer
			if = {
				limit = { stewardship = 12 }
				create_artifact_craftsman_effect = yes
				new_character = {
					upgrade_artifact_craftsman_stats_effect = yes
					save_event_target_as = target_local_candidate_craftsman
				}
			}
			else = {
				random_courtier_or_vassal = {
					limit = {
						char_can_buy_artifacts_no_flag_trigger = yes
						OR = {
							stewardship = 10
							has_job_title = job_treasurer
						}
						reverse_opinion = { who = PREV value = 10 }																		# employer opinion about char
						opinion = { who = PREV value = 10 }																				# char opinion about employer
						NOT = {
							is_foe = PREV																								# employer is not char foe
							PREV = { is_foe = PREV }																					# char is not employer foe
							reverse_has_opinion_modifier = { who = PREV modifier = opinion_rejected_request_to_find_craftsman_for_me }	# not rejected request recently
						}
					}
					preferred_limit = { ai = no }
					preferred_limit = { has_job_title = job_treasurer }
					preferred_limit = { stewardship = 20 }
					preferred_limit = { stewardship = 16 }
					preferred_limit = { stewardship = 12 }
					save_event_target_as = target_my_little_artifacts_finding_slave_candidate
				}
			}
			if = {
				limit = {
					any_realm_wonder_upgrade = {
						has_wonder_upgrade = upgrade_armory
						is_active = yes
					}
				}
				random_realm_wonder_upgrade = {
					limit = {
						has_wonder_upgrade = upgrade_armory
						is_active = yes
					}
					wonder = { save_event_target_as = target_armory_candidate_craftsman_wonder }
					save_event_target_as = target_armory_candidate_craftsman_wonder_upgrade_armory
				}
				create_artifact_craftsman_effect = yes
				new_character = {
					upgrade_artifact_craftsman_stats_effect = yes
					upgrade_artifact_craftsman_stats_effect = yes
					save_event_target_as = target_armory_candidate_craftsman
				}
			}
		}
	}

	after = {
		hidden_effect = {
			event_target:target_armory_candidate_craftsman = { leave_court_and_die_effect = yes }
			event_target:target_local_candidate_craftsman = { leave_court_and_die_effect = yes }
			clear_event_target = target_my_little_artifacts_finding_slave_candidate
		}
	}

	option = { # Send heralds
		name = EVTOPT_WCAE_150_04

		trigger = {
			stewardship < 12

			NOR = {
				event_target:target_my_little_artifacts_finding_slave_candidate = { char_can_buy_artifacts_no_flag_trigger = yes }
				any_realm_wonder_upgrade = {
					limit = {
						has_wonder_upgrade = upgrade_armory
						is_active = yes
					}
					always = yes
				}
			}
		}

		scaled_wealth = { value = -0.25 min = -25 max = -2500 }

		# random_buy_artifact_effect = yes
		# event
	}

	option = { # Send Ñourtier
		name = EVTOPT_WCAE_150_03

		trigger = {
			stewardship < 12
			event_target:target_my_little_artifacts_finding_slave_candidate = { char_can_buy_artifacts_no_flag_trigger = yes }

			NOT = {
				any_realm_wonder_upgrade = {
					limit = {
						has_wonder_upgrade = upgrade_armory
						is_active = yes
					}
					always = yes
				}
			}
		}

		event_target:target_my_little_artifacts_finding_slave_candidate = {
			save_event_target_as = target_my_little_artifacts_finding_slave
			character_event = { id = WCAE.200 days = 7 random = 7 }
		}
	}

	option = { # I know local one
		name = EVTOPT_WCAE_150_01
		tooltip_info = stewardship

		trigger = {
			stewardship = 12
			event_target:target_local_candidate_craftsman = { char_can_buy_artifacts_no_flag_trigger = yes }
		}

		set_character_flag = hired_local_craftsman_flag
		event_target:target_local_candidate_craftsman = {
			show_scope_change = no
			move_character = ROOT
			save_event_target_as = target_artifact_craftsman
			clear_event_target = target_local_candidate_craftsman
		}

		character_event = { id = WCAE.100 days = 7 random = 7 }
	}

	option = { # I know one in the armory
		name = EVTOPT_WCAE_150_02
		tooltip_info_custom = EVTOPTC_MNM_9115_TT

		trigger = {
			event_target:target_armory_candidate_craftsman = { char_can_buy_artifacts_no_flag_trigger = yes }
		}

		set_character_flag = hired_armory_craftsman_flag
		event_target:target_armory_candidate_craftsman = {
			show_scope_change = no
			move_character = ROOT
			save_event_target_as = target_artifact_craftsman
			clear_event_target = hired_armory_craftsman_flag
		}

		character_event = { id = WCAE.100 days = 14 random = 7 }
	}

	option = { # Do it yourself
		name = EVTOPT_WCAE_150_05

		trigger = {
			diplomacy < 16
			intrigue < 12
			NOT = { trait = slothful	}
			NOT = { trait = craven		}
			NOT = {	trait = shy			}
			NOT = { trait = proud		}
		}

		scaled_prestige = { value = -3 min = -10 max = -1000 }

		random = {
			chance = 10

			add_trait = diligent
		}

		character_event = { id = WCAE.100 days = 14 random = 14 }
	}

	option = { # Do it yourself, but incognito
		name = EVTOPT_WCAE_150_06
		tooltip_info = intrigue

		trigger = {
			diplomacy < 16
			intrigue = 12
			NOT = { trait = slothful	}
			NOT = { trait = craven		}
			NOT = {	trait = shy			}
			NOT = { trait = proud		}
		}

		random = {
			chance = 25

			add_trait = diligent
		}

		character_event = { id = WCAE.100 days = 28 random = 14 }
	}

	option = { # Do it yourself, but you will still look good.
		name = EVTOPT_WCAE_150_07
		tooltip_info = diplomacy

		trigger = {
			diplomacy = 16
			NOT = { trait = slothful	}
			NOT = { trait = craven		}
			NOT = {	trait = shy			}
		}

		random = {
			chance = 5

			add_trait = diligent
		}

		prestige = 25

		character_event = { id = WCAE.100 days = 28 random = 14 }
	}

	option = { # Nope
		name = EVT_OPTD_MNM_9310

		hidden_effect = {
			set_variable = { which = artifact_market_cost_variable value = 0 }
			clr_character_flag = bought_thing_recently
			clear_flags_with_prefix = bought_from_
			clear_flags_with_prefix = bought_artifact_
		}
	}
}

# Search

letter_event = { # Ping employer's slave
	id = WCAE.200
	desc = EVTDESC_WCAE_200

	border = GFX_event_letter_frame_economy

	is_triggered_only = yes

	option = { #Go work
		name = EVTOPT_WCMEME_ofc

		# Event

		event_target:target_artifact_craftsman_employer = { opinion = { modifier = opinion_grateful who = event_target:target_my_little_artifacts_finding_slave years = 3 } }

		random = {
			chance = 10

			if = {
				limit = { trait = greedy }
				remove_trait = greedy
			}
			else = {
				add_trait = charitable
			}
		}
	}

	option = {
		name = EVTOPT_WCMEME_willyoupayme

		character_event = { id = WCAE.201 days = 7 random = 7 }

		random = {
			chance = 10

			if = {
				limit = { trait = charitable }
				remove_trait = charitable
			}
		}
	}

	option = {
		name = EVTOPT_WCMEME_nope

		#Event
		event_target:target_artifact_craftsman_employer = { opinion = { modifier = opinion_rejected_request_to_find_craftsman_for_me who = event_target:target_my_little_artifacts_finding_slave years = 5 } }
	}

	option = {
		name = EVTOPT_WCMEME_never

		#Event
		event_target:target_artifact_craftsman_employer = { opinion = { modifier = opinion_rejected_request_to_find_craftsman_for_me who = event_target:target_my_little_artifacts_finding_slave years = 100 } }
	}

}

letter_event = { # PAY ME
	id = WCAE.201
	desc = EVTDESC_WCAE_201

	border = GFX_event_letter_frame_economy

	is_triggered_only = yes

	option = { # ok
		name = ok

		tooltip = { transfer_scaled_wealth = { to = event_target:target_my_little_artifacts_finding_slave value = 0.25} }
	}

	option = { # ok nut not ok
		name = notokbutok

		tooltip = { transfer_scaled_wealth = { to = event_target:target_my_little_artifacts_finding_slave value = 0.1} }
	}

	option = { # not ok
		name = notok
		#hidden_effect = {}
		opinion = { modifier = got_money_request who = event_target:target_artifact_craftsman_employer years = 5 }
	}
}

letter_event = { # Got money
	id = WCAE.202
	desc = EVTDESC_WCAE_202

	border = GFX_event_letter_frame_economy

	is_triggered_only = yes

	option = {
		name = #Go work
	}

}

letter_event = { # Got a little money
	id = WCAE.203
	desc = EVTDESC_WCAE_203

	border = GFX_event_letter_frame_economy

	is_triggered_only = yes

	option = {
		name = #Go work

		opinion = { modifier = got_money_request who = event_target:target_artifact_craftsman_employer years = 5 }
	}

}

letter_event = { # Got no money
	id = WCAE.204
	desc = EVTDESC_WCAE_204

	border = GFX_event_letter_frame_economy

	is_triggered_only = yes

	after = {
		opinion = { modifier = got_money_request who = event_target:target_artifact_craftsman_employer years = 5 }
	}

	option = {
		name = #Go work

		opinion = { modifier = opinion_grateful who = event_target:target_artifact_craftsman_employer years = 3 }
	}

	option = {
		name = #No money no work

		opinion = { modifier = opinion_rejected_request_to_find_craftsman_for_me who = event_target:target_artifact_craftsman_employer years = 5 }

		random = {
			chance = 10

			if = {
				limit = { trait = charitable }
				remove_trait = charitable
			}
		}
	}

}

# Do it yourself

# Search pings

letter_event = { # Go work ping
	id = WCAE.250
	desc = EVTDESC_WCAE_250

	is_triggered_only = yes

	option = {
		name = # Ok
	}

}

letter_event = { # No work ping
	id = WCAE.251
	desc = EVTDESC_WCAE_251

	is_triggered_only = yes

	option = {
		name = # Ok
	}

}

# Pings

character_event = { # Employer Error
	id = WCAE.900
	desc = EVTDESC_WCAE_900

	is_triggered_only = yes

	option = {
		name = # Ok
	}

}

character_event = { # Searcher Error
	id = WCAE.901
	desc = EVTDESC_WCAE_901

	is_triggered_only = yes

	option = {
		name = # Ok
	}

}

character_event = { # Craftsman Error
	id = WCAE.902
	desc = EVTDESC_WCAE_902

	is_triggered_only = yes

	option = {
		name = # Ok
	}

}